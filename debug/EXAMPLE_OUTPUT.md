# battle_detailed.py 输出示例

本文档展示不同场景下的输出示例。

## 场景1: 单局详细对局（n-games=1）

```bash
python debug/battle_detailed.py --mode nn-vs-tree --n-games 1
```

**输出内容：**
- 每一步的详细信息
- 棋盘状态可视化
- 视角转换过程
- 动作预测和合法性检查
- **不显示统计总结**（只有1局）

---

## 场景2: 多局对战统计（n-games > 1）

```bash
python debug/battle_detailed.py --mode both --n-games 10 --epsilon 0.2
```

**输出内容：**

### 每局的详细信息
```
================================================================================
游戏 1/10: 神经网络 (X) vs 决策树 (O)
================================================================================
...（详细对局过程）...

================================================================================
游戏 2/10: 神经网络 (X) vs 决策树 (O)
================================================================================
...（详细对局过程）...
```

### 场景1总结（神经网络 vs 决策树）
```
████████████████████████████████████████████████████████████████████████████████
对战总结 BATTLE SUMMARY
████████████████████████████████████████████████████████████████████████████████

对阵: 神经网络 (X 先手) vs 决策树 (O 后手)
总局数: 10

────────────────────────────────────────────────────────────────────────────────
胜负统计:
────────────────────────────────────────────────────────────────────────────────
  神经网络 (X) 获胜:   8 局  ( 80.0%)
  决策树 (O) 获胜:   0 局  (  0.0%)
  平局:                2 局  ( 20.0%)

────────────────────────────────────────────────────────────────────────────────
非法移动统计:
────────────────────────────────────────────────────────────────────────────────
  总计: 8 次
  神经网络 非法移动:   0 次
  决策树 非法移动:   8 次

────────────────────────────────────────────────────────────────────────────────
分析:
────────────────────────────────────────────────────────────────────────────────
  ⚠️  非法移动率: 80.0% (8/10)
  ⚠️  决策树 存在非法移动问题
  ❌ 严重问题：超过50%的对局出现非法移动
     建议：检查视角转换逻辑和模型训练数据
  ⚠️  神经网络 压倒性优势，可能存在问题
================================================================================
```

### 场景2总结（决策树 vs 神经网络）
```
████████████████████████████████████████████████████████████████████████████████
对战总结 BATTLE SUMMARY
████████████████████████████████████████████████████████████████████████████████

对阵: 决策树 (X 先手) vs 神经网络 (O 后手)
总局数: 10

────────────────────────────────────────────────────────────────────────────────
胜负统计:
────────────────────────────────────────────────────────────────────────────────
  决策树 (X) 获胜:   0 局  (  0.0%)
  神经网络 (O) 获胜:  10 局  (100.0%)
  平局:                0 局  (  0.0%)

────────────────────────────────────────────────────────────────────────────────
非法移动统计:
────────────────────────────────────────────────────────────────────────────────
  总计: 0 次
  决策树 非法移动:   0 次
  神经网络 非法移动:   0 次

────────────────────────────────────────────────────────────────────────────────
分析:
────────────────────────────────────────────────────────────────────────────────
  ✅ 无非法移动，对战过程合法
  ⚠️  神经网络 压倒性优势，可能存在问题
================================================================================
```

---

## 分析解读说明

### 总结报告包含的内容

1. **胜负统计**
   - 各玩家的胜率
   - 平局率
   - 用于评估模型强度对比

2. **非法移动统计**
   - 总计非法移动次数
   - 各玩家的非法移动次数
   - 非法移动率（关键指标）

3. **智能分析**
   - ✅ 无非法移动：对战过程合法
   - ⚠️ 中等问题（10-50%非法移动率）：建议测试随机探索
   - ❌ 严重问题（>50%非法移动率）：需要检查视角转换和训练数据
   - 高平局率（>80%）：模型策略接近最优
   - 压倒性优势（>80%胜率）：可能存在问题

### 典型问题模式

#### 问题1: 一方总是非法移动
```
  神经网络 非法移动:   0 次
  决策树 非法移动:  10 次
```
**原因：** 决策树可能存在视角转换问题或训练数据不足

#### 问题2: 先手正常，后手非法
```
场景1 (NN先手): 决策树 8次非法移动
场景2 (Tree先手): 决策树 0次非法移动
```
**原因：** 决策树作为后手时视角转换有问题

#### 问题3: 都是平局
```
  平局:  100 局  (100.0%)
```
**原因：** 两个模型策略相同或都达到最优

---

## 使用建议

### 快速诊断流程

1. **运行10局快速测试**
   ```bash
   python debug/battle_detailed.py --mode both --n-games 10
   ```

2. **查看总结报告**
   - 关注"非法移动率"
   - 关注"分析"部分的建议

3. **根据问题采取行动**
   - 非法移动率高：运行单局详细日志找出问题步骤
   - 一方压倒性优势：对比两个场景的结果
   - 全是平局：模型训练正常，策略接近最优

### 批量测试建议

```bash
# 测试100局统计稳定性
python debug/battle_detailed.py --n-games 100 --epsilon 0.0 > test_100.log

# 提取统计信息
grep "对战总结" test_100.log -A 30
```
